var fx=function(){function a(a,b,c){return Math.max(a,Math.min(b,c))}function b(a){return{_:a,loadContentsOf:function(a){O=this._.gl,this._.loadContentsOf(a)},destroy:function(){O=this._.gl,this._.destroy()}}}function c(a){return b(Q.fromElement(a))}function d(a){return new S(this,a)}function e(a,b){var c=O.UNSIGNED_BYTE;if(O.getExtension("OES_texture_float")&&O.getExtension("OES_texture_float_linear")){var d=new Q(100,100,O.RGBA,O.FLOAT);try{d.drawTo(function(){c=O.FLOAT})}catch(e){}d.destroy()}this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=a,this.height=b,this._.texture=new Q(a,b,O.RGBA,c),this._.spareTexture=new Q(a,b,O.RGBA,c),this._.extraTexture=this._.extraTexture||new Q(0,0,O.RGBA,c),this._.flippedShader=this._.flippedShader||new P(null,"uniform sampler2D texture;varying vec2 texCoord;void main(){gl_FragColor=texture2D(texture,vec2(texCoord.x,1.0-texCoord.y));}"),this._.isInitialized=!0}function f(a,b,c){return this._.isInitialized&&a._.width==this.width&&a._.height==this.height||e.call(this,b?b:a._.width,c?c:a._.height),a._.use(),this._.texture.drawTo(function(){P.getDefaultShader().drawRect()}),this}function g(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function h(a,b,c,d){(c||this._.texture).use(),this._.spareTexture.drawTo(function(){a.uniforms(b).drawRect()}),this._.spareTexture.swapWith(d||this._.texture)}function i(a){return a.parentNode.insertBefore(this,a),a.parentNode.removeChild(a),this}function j(){var a=new Q(this._.texture.width,this._.texture.height,O.RGBA,O.UNSIGNED_BYTE);return this._.texture.use(),a.drawTo(function(){P.getDefaultShader().drawRect()}),b(a)}function k(){var a=this._.texture.width,b=this._.texture.height,c=new Uint8Array(a*b*4);return this._.texture.drawTo(function(){}),O.readPixels(0,0,a,b,O.RGBA,O.UNSIGNED_BYTE,c),c}function l(a){return function(){return O=this._.gl,a.apply(this,arguments)}}function m(a,b,c,d,e,f,g,h){var i=c-e,j=d-f,k=g-e,l=h-f;e=a-c+e-g,f=b-d+f-h;var m=i*l-k*j,k=(e*l-k*f)/m,i=(i*f-e*j)/m;return[c-a+k*c,d-b+k*d,k,g-a+i*g,h-b+i*h,i,a,b,1]}function n(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7];a=a[8];var j=b*f*a-b*g*i-c*e*a+c*g*h+d*e*i-d*f*h;return[(f*a-g*i)/j,(d*i-c*a)/j,(c*g-d*f)/j,(g*h-e*a)/j,(b*a-d*h)/j,(d*e-b*g)/j,(e*i-f*h)/j,(c*h-b*i)/j,(b*f-c*e)/j]}function o(a){var b=a.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],a.sort(function(a,b){return a[0]-b[0]});for(var c=0;b>c;c++)this.xa.push(a[c][0]),this.ya.push(a[c][1]);for(this.u[0]=0,this.y2[0]=0,c=1;b-1>c;++c){a=this.xa[c+1]-this.xa[c-1];var d=(this.xa[c]-this.xa[c-1])/a,e=d*this.y2[c-1]+2;this.y2[c]=(d-1)/e,this.u[c]=(6*((this.ya[c+1]-this.ya[c])/(this.xa[c+1]-this.xa[c])-(this.ya[c]-this.ya[c-1])/(this.xa[c]-this.xa[c-1]))/a-d*this.u[c-1])/e}for(this.y2[b-1]=0,c=b-2;c>=0;--c)this.y2[c]=this.y2[c]*this.y2[c+1]+this.u[c]}function p(a,b){return new P(null,a+"uniform sampler2D texture;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 coord=texCoord*texSize;"+b+"gl_FragColor=texture2D(texture,coord/texSize);vec2 clampedCoord=clamp(coord,vec2(0.0),texSize);if(coord!=clampedCoord){gl_FragColor.a*=max(0.0,1.0-length(coord-clampedCoord));}}")}function q(b,c){return O.brightnessContrast=O.brightnessContrast||new P(null,"uniform sampler2D texture;uniform float brightness;uniform float contrast;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color.rgb+=brightness;if(contrast>0.0){color.rgb=(color.rgb-0.5)/(1.0-contrast)+0.5;}else{color.rgb=(color.rgb-0.5)*(1.0+contrast)+0.5;}gl_FragColor=color;}"),h.call(this,O.brightnessContrast,{brightness:a(-1,b,1),contrast:a(-1,c,1)}),this}function r(b){b=new o(b);for(var c=[],d=0;256>d;d++)c.push(a(0,Math.floor(256*b.interpolate(d/255)),255));return c}function s(a,b,c){a=r(a),1==arguments.length?b=c=a:(b=r(b),c=r(c));for(var d=[],e=0;256>e;e++)d.splice(d.length,0,a[e],b[e],c[e],255);return this._.extraTexture.initFromBytes(256,1,d),this._.extraTexture.use(1),O.curves=O.curves||new P(null,"uniform sampler2D texture;uniform sampler2D map;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color.r=texture2D(map,vec2(color.r)).r;color.g=texture2D(map,vec2(color.g)).g;color.b=texture2D(map,vec2(color.b)).b;gl_FragColor=color;}"),O.curves.textures({map:1}),h.call(this,O.curves,{}),this}function t(a){O.denoise=O.denoise||new P(null,"uniform sampler2D texture;uniform float exponent;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;void main(){vec4 center=texture2D(texture,texCoord);vec4 color=vec4(0.0);float total=0.0;for(float x=-4.0;x<=4.0;x+=1.0){for(float y=-4.0;y<=4.0;y+=1.0){vec4 sample=texture2D(texture,texCoord+vec2(x,y)/texSize);float weight=1.0-abs(dot(sample.rgb-center.rgb,vec3(0.25)));weight=pow(weight,exponent);color+=sample*weight;total+=weight;}}gl_FragColor=color/total;}");for(var b=0;2>b;b++)h.call(this,O.denoise,{exponent:Math.max(0,a),texSize:[this.width,this.height]});return this}function u(b,c){return O.hueSaturation=O.hueSaturation||new P(null,"uniform sampler2D texture;uniform float hue;uniform float saturation;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float angle=hue*3.14159265;float s=sin(angle),c=cos(angle);vec3 weights=(vec3(2.0*c,-sqrt(3.0)*s-c,sqrt(3.0)*s-c)+1.0)/3.0;float len=length(color.rgb);color.rgb=vec3(dot(color.rgb,weights.xyz),dot(color.rgb,weights.zxy),dot(color.rgb,weights.yzx));float average=(color.r+color.g+color.b)/3.0;if(saturation>0.0){color.rgb+=(average-color.rgb)*(1.0-1.0/(1.001-saturation));}else{color.rgb+=(average-color.rgb)*(-saturation);}gl_FragColor=color;}"),h.call(this,O.hueSaturation,{hue:a(-1,b,1),saturation:a(-1,c,1)}),this}function v(b){return O.noise=O.noise||new P(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec4 color=texture2D(texture,texCoord);float diff=(rand(texCoord)-0.5)*amount;color.r+=diff;color.g+=diff;color.b+=diff;gl_FragColor=color;}"),h.call(this,O.noise,{amount:a(0,b,1)}),this}function w(b){return O.sepia=O.sepia||new P(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float r=color.r;float g=color.g;float b=color.b;color.r=min(1.0,(r*(1.0-(0.607*amount)))+(g*(0.769*amount))+(b*(0.189*amount)));color.g=min(1.0,(r*0.349*amount)+(g*(1.0-(0.314*amount)))+(b*0.168*amount));color.b=min(1.0,(r*0.272*amount)+(g*0.534*amount)+(b*(1.0-(0.869*amount))));gl_FragColor=color;}"),h.call(this,O.sepia,{amount:a(0,b,1)}),this}function x(a,b){return O.unsharpMask=O.unsharpMask||new P(null,"uniform sampler2D blurredTexture;uniform sampler2D originalTexture;uniform float strength;uniform float threshold;varying vec2 texCoord;void main(){vec4 blurred=texture2D(blurredTexture,texCoord);vec4 original=texture2D(originalTexture,texCoord);gl_FragColor=mix(blurred,original,1.0+strength);}"),this._.extraTexture.ensureFormat(this._.texture),this._.texture.use(),this._.extraTexture.drawTo(function(){P.getDefaultShader().drawRect()}),this._.extraTexture.use(1),this.triangleBlur(a),O.unsharpMask.textures({originalTexture:1}),h.call(this,O.unsharpMask,{strength:b}),this._.extraTexture.unuse(1),this}function y(b){return O.vibrance=O.vibrance||new P(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float average=(color.r+color.g+color.b)/3.0;float mx=max(color.r,max(color.g,color.b));float amt=(mx-average)*(-amount*3.0);color.rgb=mix(color.rgb,vec3(mx),amt);gl_FragColor=color;}"),h.call(this,O.vibrance,{amount:a(-1,b,1)}),this}function z(b,c){return O.vignette=O.vignette||new P(null,"uniform sampler2D texture;uniform float size;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float dist=distance(texCoord,vec2(0.5,0.5));color.rgb*=smoothstep(0.8,size*0.799,dist*(amount+size));gl_FragColor=color;}"),h.call(this,O.vignette,{size:a(0,b,1),amount:a(0,c,1)}),this}function A(b,c,d){O.lensBlurPrePass=O.lensBlurPrePass||new P(null,"uniform sampler2D texture;uniform float power;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color=pow(color,vec4(power));gl_FragColor=vec4(color);}");var e="uniform sampler2D texture0;uniform sampler2D texture1;uniform vec2 delta0;uniform vec2 delta1;uniform float power;varying vec2 texCoord;"+R+"vec4 sample(vec2 delta){float offset=random(vec3(delta,151.7182),0.0);vec4 color=vec4(0.0);float total=0.0;for(float t=0.0;t<=30.0;t++){float percent=(t+offset)/30.0;color+=texture2D(texture0,texCoord+delta*percent);total+=1.0;}return color/total;}";O.lensBlur0=O.lensBlur0||new P(null,e+"void main(){gl_FragColor=sample(delta0);}"),O.lensBlur1=O.lensBlur1||new P(null,e+"void main(){gl_FragColor=(sample(delta0)+sample(delta1))*0.5;}"),O.lensBlur2=O.lensBlur2||new P(null,e+"void main(){vec4 color=(sample(delta0)+2.0*texture2D(texture1,texCoord))/3.0;gl_FragColor=pow(color,vec4(power));}").textures({texture1:1});for(var e=[],f=0;3>f;f++){var g=d+f*Math.PI*2/3;e.push([b*Math.sin(g)/this.width,b*Math.cos(g)/this.height])}return b=Math.pow(10,a(-1,c,1)),h.call(this,O.lensBlurPrePass,{power:b}),this._.extraTexture.ensureFormat(this._.texture),h.call(this,O.lensBlur0,{delta0:e[0]},this._.texture,this._.extraTexture),h.call(this,O.lensBlur1,{delta0:e[1],delta1:e[2]},this._.extraTexture,this._.extraTexture),h.call(this,O.lensBlur0,{delta0:e[1]}),this._.extraTexture.use(1),h.call(this,O.lensBlur2,{power:1/b,delta0:e[2]}),this}function B(a,b,c,d,e,f){O.tiltShift=O.tiltShift||new P(null,"uniform sampler2D texture;uniform float blurRadius;uniform float gradientRadius;uniform vec2 start;uniform vec2 end;uniform vec2 delta;uniform vec2 texSize;varying vec2 texCoord;"+R+"void main(){vec4 color=vec4(0.0);float total=0.0;float offset=random(vec3(12.9898,78.233,151.7182),0.0);vec2 normal=normalize(vec2(start.y-end.y,end.x-start.x));float radius=smoothstep(0.0,1.0,abs(dot(texCoord*texSize-start,normal))/gradientRadius)*blurRadius;for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec4 sample=texture2D(texture,texCoord+delta/texSize*percent*radius);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}");var g=c-a,i=d-b,j=Math.sqrt(g*g+i*i);return h.call(this,O.tiltShift,{blurRadius:e,gradientRadius:f,start:[a,b],end:[c,d],delta:[g/j,i/j],texSize:[this.width,this.height]}),h.call(this,O.tiltShift,{blurRadius:e,gradientRadius:f,start:[a,b],end:[c,d],delta:[-i/j,g/j],texSize:[this.width,this.height]}),this}function C(a){return O.triangleBlur=O.triangleBlur||new P(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+R+"void main(){vec4 color=vec4(0.0);float total=0.0;float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec4 sample=texture2D(texture,texCoord+delta*percent);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}"),h.call(this,O.triangleBlur,{delta:[a/this.width,0]}),h.call(this,O.triangleBlur,{delta:[0,a/this.height]}),this}function D(a,b,c){return O.zoomBlur=O.zoomBlur||new P(null,"uniform sampler2D texture;uniform vec2 center;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;"+R+"void main(){vec4 color=vec4(0.0);float total=0.0;vec2 toCenter=center-texCoord*texSize;float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=0.0;t<=40.0;t++){float percent=(t+offset)/40.0;float weight=4.0*(percent-percent*percent);vec4 sample=texture2D(texture,texCoord+toCenter*percent*strength/texSize);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}"),h.call(this,O.zoomBlur,{center:[a,b],strength:c,texSize:[this.width,this.height]}),this}function E(a,b,c,d){return O.colorHalftone=O.colorHalftone||new P(null,"uniform sampler2D texture;uniform vec2 center;uniform float angle;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;float pattern(float angle){float s=sin(angle),c=cos(angle);vec2 tex=texCoord*texSize-center;vec2 point=vec2(c*tex.x-s*tex.y,s*tex.x+c*tex.y)*scale;return(sin(point.x)*sin(point.y))*4.0;}void main(){vec4 color=texture2D(texture,texCoord);vec3 cmy=1.0-color.rgb;float k=min(cmy.x,min(cmy.y,cmy.z));cmy=(cmy-k)/(1.0-k);cmy=clamp(cmy*10.0-3.0+vec3(pattern(angle+0.26179),pattern(angle+1.30899),pattern(angle)),0.0,1.0);k=clamp(k*10.0-5.0+pattern(angle+0.78539),0.0,1.0);gl_FragColor=vec4(1.0-cmy-k,color.a);}"),h.call(this,O.colorHalftone,{center:[a,b],angle:c,scale:Math.PI/d,texSize:[this.width,this.height]}),this}function F(a,b,c,d){return O.dotScreen=O.dotScreen||new P(null,"uniform sampler2D texture;uniform vec2 center;uniform float angle;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;float pattern(){float s=sin(angle),c=cos(angle);vec2 tex=texCoord*texSize-center;vec2 point=vec2(c*tex.x-s*tex.y,s*tex.x+c*tex.y)*scale;return(sin(point.x)*sin(point.y))*4.0;}void main(){vec4 color=texture2D(texture,texCoord);float average=(color.r+color.g+color.b)/3.0;gl_FragColor=vec4(vec3(average*10.0-5.0+pattern()),color.a);}"),h.call(this,O.dotScreen,{center:[a,b],angle:c,scale:Math.PI/d,texSize:[this.width,this.height]}),this}function G(a){return O.edgeWork1=O.edgeWork1||new P(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+R+"void main(){vec2 color=vec2(0.0);vec2 total=vec2(0.0);float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec3 sample=texture2D(texture,texCoord+delta*percent).rgb;float average=(sample.r+sample.g+sample.b)/3.0;color.x+=average*weight;total.x+=weight;if(abs(t)<15.0){weight=weight*2.0-1.0;color.y+=average*weight;total.y+=weight;}}gl_FragColor=vec4(color/total,0.0,1.0);}"),O.edgeWork2=O.edgeWork2||new P(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+R+"void main(){vec2 color=vec2(0.0);vec2 total=vec2(0.0);float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec2 sample=texture2D(texture,texCoord+delta*percent).xy;color.x+=sample.x*weight;total.x+=weight;if(abs(t)<15.0){weight=weight*2.0-1.0;color.y+=sample.y*weight;total.y+=weight;}}float c=clamp(10000.0*(color.y/total.y-color.x/total.x)+0.5,0.0,1.0);gl_FragColor=vec4(c,c,c,1.0);}"),h.call(this,O.edgeWork1,{delta:[a/this.width,0]}),h.call(this,O.edgeWork2,{delta:[0,a/this.height]}),this}function H(a,b,c){return O.hexagonalPixelate=O.hexagonalPixelate||new P(null,"uniform sampler2D texture;uniform vec2 center;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 tex=(texCoord*texSize-center)/scale;tex.y/=0.866025404;tex.x-=tex.y*0.5;vec2 a;if(tex.x+tex.y-floor(tex.x)-floor(tex.y)<1.0)a=vec2(floor(tex.x),floor(tex.y));else a=vec2(ceil(tex.x),ceil(tex.y));vec2 b=vec2(ceil(tex.x),floor(tex.y));vec2 c=vec2(floor(tex.x),ceil(tex.y));vec3 TEX=vec3(tex.x,tex.y,1.0-tex.x-tex.y);vec3 A=vec3(a.x,a.y,1.0-a.x-a.y);vec3 B=vec3(b.x,b.y,1.0-b.x-b.y);vec3 C=vec3(c.x,c.y,1.0-c.x-c.y);float alen=length(TEX-A);float blen=length(TEX-B);float clen=length(TEX-C);vec2 choice;if(alen<blen){if(alen<clen)choice=a;else choice=c;}else{if(blen<clen)choice=b;else choice=c;}choice.x+=choice.y*0.5;choice.y*=0.866025404;choice*=scale/texSize;gl_FragColor=texture2D(texture,choice+center/texSize);}"),h.call(this,O.hexagonalPixelate,{center:[a,b],scale:c,texSize:[this.width,this.height]}),this}function I(a){return O.ink=O.ink||new P(null,"uniform sampler2D texture;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 dx=vec2(1.0/texSize.x,0.0);vec2 dy=vec2(0.0,1.0/texSize.y);vec4 color=texture2D(texture,texCoord);float bigTotal=0.0;float smallTotal=0.0;vec3 bigAverage=vec3(0.0);vec3 smallAverage=vec3(0.0);for(float x=-2.0;x<=2.0;x+=1.0){for(float y=-2.0;y<=2.0;y+=1.0){vec3 sample=texture2D(texture,texCoord+dx*x+dy*y).rgb;bigAverage+=sample;bigTotal+=1.0;if(abs(x)+abs(y)<2.0){smallAverage+=sample;smallTotal+=1.0;}}}vec3 edge=max(vec3(0.0),bigAverage/bigTotal-smallAverage/smallTotal);gl_FragColor=vec4(color.rgb-dot(edge,edge)*strength*100000.0,color.a);}"),h.call(this,O.ink,{strength:a*a*a*a*a,texSize:[this.width,this.height]}),this}function J(b,c,d,e){return O.bulgePinch=O.bulgePinch||p("uniform float radius;uniform float strength;uniform vec2 center;","coord-=center;float distance=length(coord);if(distance<radius){float percent=distance/radius;if(strength>0.0){coord*=mix(1.0,smoothstep(0.0,radius/distance,percent),strength*0.75);}else{coord*=mix(1.0,pow(percent,1.0+strength*0.75)*radius/distance,1.0-percent);}}coord+=center;"),h.call(this,O.bulgePinch,{radius:d,strength:a(-1,e,1),center:[b,c],texSize:[this.width,this.height]}),this}function K(a,b,c){if(O.matrixWarp=O.matrixWarp||p("uniform mat3 matrix;uniform bool useTextureSpace;","if(useTextureSpace)coord=coord/texSize*2.0-1.0;vec3 warp=matrix*vec3(coord,1.0);coord=warp.xy/warp.z;if(useTextureSpace)coord=(coord*0.5+0.5)*texSize;"),a=Array.prototype.concat.apply([],a),4==a.length)a=[a[0],a[1],0,a[2],a[3],0,0,0,1];else if(9!=a.length)throw"can only warp with 2x2 or 3x3 matrix";return h.call(this,O.matrixWarp,{matrix:b?n(a):a,texSize:[this.width,this.height],useTextureSpace:0|c}),this}function L(a,b){var c=m.apply(null,b),d=m.apply(null,a),c=n(c);return this.matrixWarp([c[0]*d[0]+c[1]*d[3]+c[2]*d[6],c[0]*d[1]+c[1]*d[4]+c[2]*d[7],c[0]*d[2]+c[1]*d[5]+c[2]*d[8],c[3]*d[0]+c[4]*d[3]+c[5]*d[6],c[3]*d[1]+c[4]*d[4]+c[5]*d[7],c[3]*d[2]+c[4]*d[5]+c[5]*d[8],c[6]*d[0]+c[7]*d[3]+c[8]*d[6],c[6]*d[1]+c[7]*d[4]+c[8]*d[7],c[6]*d[2]+c[7]*d[5]+c[8]*d[8]])}function M(a,b,c,d){return O.swirl=O.swirl||p("uniform float radius;uniform float angle;uniform vec2 center;","coord-=center;float distance=length(coord);if(distance<radius){float percent=(radius-distance)/radius;float theta=percent*percent*angle;float s=sin(theta);float c=cos(theta);coord=vec2(coord.x*c-coord.y*s,coord.x*s+coord.y*c);}coord+=center;"),h.call(this,O.swirl,{radius:c,center:[a,b],angle:d,texSize:[this.width,this.height]}),this}var N={};!function(){function a(a){if(!a.getExtension("OES_texture_float"))return!1;var b=a.createFramebuffer(),c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,null),a.bindFramebuffer(a.FRAMEBUFFER,b),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0),b=a.createTexture(),a.bindTexture(a.TEXTURE_2D,b),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2,2,0,a.RGBA,a.FLOAT,new Float32Array([2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]));var c=a.createProgram(),d=a.createShader(a.VERTEX_SHADER),e=a.createShader(a.FRAGMENT_SHADER);return a.shaderSource(d,"attribute vec2 vertex;void main(){gl_Position=vec4(vertex,0.0,1.0);}"),a.shaderSource(e,"uniform sampler2D texture;void main(){gl_FragColor=texture2D(texture,vec2(0.5));}"),a.compileShader(d),a.compileShader(e),a.attachShader(c,d),a.attachShader(c,e),a.linkProgram(c),d=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,d),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0]),a.STREAM_DRAW),a.enableVertexAttribArray(0),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0),d=new Uint8Array(4),a.useProgram(c),a.viewport(0,0,1,1),a.bindTexture(a.TEXTURE_2D,b),a.drawArrays(a.POINTS,0,1),a.readPixels(0,0,1,1,a.RGBA,a.UNSIGNED_BYTE,d),127===d[0]||128===d[0]}function b(){}function c(a){return"OES_texture_float_linear"===a?(void 0===this.$OES_texture_float_linear$&&Object.defineProperty(this,"$OES_texture_float_linear$",{enumerable:!1,configurable:!1,writable:!1,value:new b}),a=this.$OES_texture_float_linear$):a=g.call(this,a),a}function d(){var a=h.call(this);return-1===a.indexOf("OES_texture_float_linear")&&a.push("OES_texture_float_linear"),a}try{var e=document.createElement("canvas").getContext("experimental-webgl")}catch(f){}if(e&&-1===e.getSupportedExtensions().indexOf("OES_texture_float_linear")&&a(e)){var g=WebGLRenderingContext.prototype.getExtension,h=WebGLRenderingContext.prototype.getSupportedExtensions;WebGLRenderingContext.prototype.getExtension=c,WebGLRenderingContext.prototype.getSupportedExtensions=d}}();var O;N.canvas=function(){var a=document.createElement("canvas");try{O=a.getContext("experimental-webgl",{premultipliedAlpha:!1})}catch(b){O=null}if(!O)throw"This browser does not support WebGL";return a._={gl:O,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},a.texture=l(c),a.draw=l(f),a.update=l(g),a.replace=l(i),a.contents=l(j),a.getPixelArray=l(k),a.brightnessContrast=l(q),a.hexagonalPixelate=l(H),a.hueSaturation=l(u),a.colorHalftone=l(E),a.triangleBlur=l(C),a.unsharpMask=l(x),a.perspective=l(L),a.matrixWarp=l(K),a.bulgePinch=l(J),a.tiltShift=l(B),a.dotScreen=l(F),a.edgeWork=l(G),a.lensBlur=l(A),a.zoomBlur=l(D),a.noise=l(v),a.denoise=l(t),a.curves=l(s),a.swirl=l(M),a.ink=l(I),a.vignette=l(z),a.vibrance=l(y),a.sepia=l(w),a.glitch=l(d),a},N.splineInterpolate=r,N.ALPHA=6406,N.LUMINANCE=6409,N.LUMINANCE_ALPHA=6410,N.RGB=6407,N.RGBA=6408,N.UNSIGNED_BYTE=5121,N.UNSIGNED_SHORT_4_4_4_4=32819,N.UNSIGNED_SHORT_5_5_5_1=32820,N.UNSIGNED_SHORT_5_6_5=33635;var P=function(){function a(a,b){var c=O.createShader(a);if(O.shaderSource(c,b),O.compileShader(c),!O.getShaderParameter(c,O.COMPILE_STATUS))throw"compile error: "+O.getShaderInfoLog(c);return c}function b(b,c){if(this.texCoordAttribute=this.vertexAttribute=null,this.program=O.createProgram(),c="precision highp float;"+(c||"uniform sampler2D texture;varying vec2 texCoord;void main(){gl_FragColor=texture2D(texture,texCoord);}"),O.attachShader(this.program,a(O.VERTEX_SHADER,b||"attribute vec2 vertex;attribute vec2 _texCoord;varying vec2 texCoord;void main(){texCoord=_texCoord;gl_Position=vec4(vertex*2.0-1.0,0.0,1.0);}")),O.attachShader(this.program,a(O.FRAGMENT_SHADER,c)),O.linkProgram(this.program),!O.getProgramParameter(this.program,O.LINK_STATUS))throw"link error: "+O.getProgramInfoLog(this.program)}return b.prototype.destroy=function(){O.deleteProgram(this.program),this.program=null},b.prototype.uniforms=function(a){O.useProgram(this.program);for(var b in a)if(a.hasOwnProperty(b)){var c=O.getUniformLocation(this.program,b);if(null!==c){var d=a[b];if("[object Array]"==Object.prototype.toString.call(d))switch(d.length){case 1:O.uniform1fv(c,new Float32Array(d));break;case 2:O.uniform2fv(c,new Float32Array(d));break;case 3:O.uniform3fv(c,new Float32Array(d));break;case 4:O.uniform4fv(c,new Float32Array(d));break;case 9:O.uniformMatrix3fv(c,!1,new Float32Array(d));break;case 16:O.uniformMatrix4fv(c,!1,new Float32Array(d));break;default:throw"dont't know how to load uniform \""+b+'" of length '+d.length}else{if("[object Number]"!=Object.prototype.toString.call(d))throw'attempted to set uniform "'+b+'" to invalid value '+(d||"undefined").toString();O.uniform1f(c,d)}}}return this},b.prototype.textures=function(a){O.useProgram(this.program);for(var b in a)a.hasOwnProperty(b)&&O.uniform1i(O.getUniformLocation(this.program,b),a[b]);return this},b.prototype.drawRect=function(a,b,c,d){var e=O.getParameter(O.VIEWPORT);b=void 0!==b?(b-e[1])/e[3]:0,a=void 0!==a?(a-e[0])/e[2]:0,c=void 0!==c?(c-e[0])/e[2]:1,d=void 0!==d?(d-e[1])/e[3]:1,null==O.vertexBuffer&&(O.vertexBuffer=O.createBuffer()),O.bindBuffer(O.ARRAY_BUFFER,O.vertexBuffer),O.bufferData(O.ARRAY_BUFFER,new Float32Array([a,b,a,d,c,b,c,d]),O.STATIC_DRAW),null==O.texCoordBuffer&&(O.texCoordBuffer=O.createBuffer(),O.bindBuffer(O.ARRAY_BUFFER,O.texCoordBuffer),O.bufferData(O.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),O.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=O.getAttribLocation(this.program,"vertex"),O.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=O.getAttribLocation(this.program,"_texCoord"),O.enableVertexAttribArray(this.texCoordAttribute)),O.useProgram(this.program),O.bindBuffer(O.ARRAY_BUFFER,O.vertexBuffer),O.vertexAttribPointer(this.vertexAttribute,2,O.FLOAT,!1,0,0),O.bindBuffer(O.ARRAY_BUFFER,O.texCoordBuffer),O.vertexAttribPointer(this.texCoordAttribute,2,O.FLOAT,!1,0,0),O.drawArrays(O.TRIANGLE_STRIP,0,4)},b.getDefaultShader=function(){return O.defaultShader=O.defaultShader||new b,O.defaultShader},b}();o.prototype.interpolate=function(a){for(var b=0,c=this.ya.length-1;c-b>1;){var d=c+b>>1;this.xa[d]>a?c=d:b=d}var d=this.xa[c]-this.xa[b],e=(this.xa[c]-a)/d;return a=(a-this.xa[b])/d,e*this.ya[b]+a*this.ya[c]+((e*e*e-e)*this.y2[b]+(a*a*a-a)*this.y2[c])*d*d/6};var Q=function(){function a(a,b,c,d){this.gl=O,this.id=O.createTexture(),this.width=a,this.height=b,this.format=c,this.type=d,O.bindTexture(O.TEXTURE_2D,this.id),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE),a&&b&&O.texImage2D(O.TEXTURE_2D,0,this.format,a,b,0,this.format,this.type,null)}function b(a){return null==c&&(c=document.createElement("canvas")),c.width=a.width,c.height=a.height,a=c.getContext("2d"),a.clearRect(0,0,c.width,c.height),a}a.fromElement=function(b){var c=new a(0,0,O.RGBA,O.UNSIGNED_BYTE);return c.loadContentsOf(b),c},a.prototype.loadContentsOf=function(a){this.width=a.width||a.videoWidth,this.height=a.height||a.videoHeight,O.bindTexture(O.TEXTURE_2D,this.id),O.texImage2D(O.TEXTURE_2D,0,this.format,this.format,this.type,a)},a.prototype.initFromBytes=function(a,b,c){this.width=a,this.height=b,this.format=O.RGBA,this.type=O.UNSIGNED_BYTE,O.bindTexture(O.TEXTURE_2D,this.id),O.texImage2D(O.TEXTURE_2D,0,O.RGBA,a,b,0,O.RGBA,this.type,new Uint8Array(c))},a.prototype.destroy=function(){O.deleteTexture(this.id),this.id=null},a.prototype.use=function(a){O.activeTexture(O.TEXTURE0+(a||0)),O.bindTexture(O.TEXTURE_2D,this.id)},a.prototype.unuse=function(a){O.activeTexture(O.TEXTURE0+(a||0)),O.bindTexture(O.TEXTURE_2D,null)},a.prototype.ensureFormat=function(a,b,c,d){if(1==arguments.length){var e=arguments[0];a=e.width,b=e.height,c=e.format,d=e.type}(a!=this.width||b!=this.height||c!=this.format||d!=this.type)&&(this.width=a,this.height=b,this.format=c,this.type=d,O.bindTexture(O.TEXTURE_2D,this.id),O.texImage2D(O.TEXTURE_2D,0,this.format,a,b,0,this.format,this.type,null))},a.prototype.drawTo=function(a){if(O.framebuffer=O.framebuffer||O.createFramebuffer(),O.bindFramebuffer(O.FRAMEBUFFER,O.framebuffer),O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.TEXTURE_2D,this.id,0),O.checkFramebufferStatus(O.FRAMEBUFFER)!==O.FRAMEBUFFER_COMPLETE)throw Error("incomplete framebuffer");O.viewport(0,0,this.width,this.height),a(),O.bindFramebuffer(O.FRAMEBUFFER,null)};var c=null;return a.prototype.fillUsingCanvas=function(a){return a(b(this)),this.format=O.RGBA,this.type=O.UNSIGNED_BYTE,O.bindTexture(O.TEXTURE_2D,this.id),O.texImage2D(O.TEXTURE_2D,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,c),this},a.prototype.toImage=function(a){this.use(),P.getDefaultShader().drawRect();var d=this.width*this.height*4,e=new Uint8Array(d),f=b(this),g=f.createImageData(this.width,this.height);O.readPixels(0,0,this.width,this.height,O.RGBA,O.UNSIGNED_BYTE,e);for(var h=0;d>h;h++)g.data[h]=e[h];f.putImageData(g,0,0),a.src=c.toDataURL()},a.prototype.swapWith=function(a){var b;b=a.id,a.id=this.id,this.id=b,b=a.width,a.width=this.width,this.width=b,b=a.height,a.height=this.height,this.height=b,b=a.format,a.format=this.format,this.format=b},a}(),R="float random(vec3 scale,float seed){return fract(sin(dot(gl_FragCoord.xyz+seed,scale))*43758.5453+seed);}",S=function(a,b){var c=a._.gl;a.draw(b);var d,e,f,g,h,i=a.getPixelArray();this.width=function(a){return d=a=a||b._.width,this},this.height=function(a){return e=a=a||b._.height,this},this.shortenX=function(a){return d=b._.width-(a||0),this},this.shortenY=function(a){return e=b._.height-(a||0),this},this.type=function(a){switch(a){case N.UNSIGNED_BYTE:case N.UNSIGNED_SHORT_5_6_5:case N.UNSIGNED_SHORT_4_4_4_4:case N.UNSIGNED_SHORT_5_5_5_1:g=a;break;default:console.log("[GLITCH TYPE ERROR] type supports only fx.UNSIGNED_BYTE, fx.UNSIGNED_SHORT_5_6_5, fx.UNSIGNED_SHORT_4_4_4_4, fx.UNSIGNED_SHORT_5_5_5_1.")}return this},this.format=function(a){switch(a){case N.ALPHA:case N.LUMINANCE:case N.LUMINANCE_ALPHA:case N.RGB:case N.RGBA:f=a;break;default:console.log("[GLITCH FORMAT ERROR] format supports only fx.ALPHA, fx.LUMINANCE, fx.LUMINANCE_ALPHA, fx.RGB and fx.RGBA.")}return this},this.offset=function(a){var b=i.subarray(0,a);a=i.subarray(a,i.length);for(var c=new Uint8Array(i.length),d=0,e=0;e<a.length;e++)c[d]=a[e],d++;for(e=0;e<b.length;e++)c[d]=b[e],d++;return i=c,this},this.length=function(){return i.length()},this.process=function(a){return h=a||function(){},this},this.update=function(){return d=d||b._.width,e=e||b._.height,f=f||N.RGBA,g=g||N.UNSIGNED_BYTE,h=h||function(a){},h(i),c.bindTexture(c.TEXTURE_2D,b._.id),c.texImage2D(c.TEXTURE_2D,0,f,d,e,0,f,g,i),a.draw(b).update(),this}};return N}(),dat=dat||{};dat.gui=dat.gui||{},dat.utils=dat.utils||{},dat.controllers=dat.controllers||{},dat.dom=dat.dom||{},dat.color=dat.color||{},dat.utils.css=function(){return{load:function(a,b){var b=b||document,c=b.createElement("link");c.type="text/css",c.rel="stylesheet",c.href=a,b.getElementsByTagName("head")[0].appendChild(c)},inject:function(a,b){var b=b||document,c=document.createElement("style");c.type="text/css",c.innerHTML=a,b.getElementsByTagName("head")[0].appendChild(c)}}}(),dat.utils.common=function(){var a=Array.prototype.forEach,b=Array.prototype.slice;return{BREAK:{},extend:function(a){return this.each(b.call(arguments,1),function(b){for(var c in b)this.isUndefined(b[c])||(a[c]=b[c])},this),a},defaults:function(a){return this.each(b.call(arguments,1),function(b){for(var c in b)this.isUndefined(a[c])&&(a[c]=b[c])},this),a},compose:function(){var a=b.call(arguments);return function(){for(var c=b.call(arguments),d=a.length-1;d>=0;d--)c=[a[d].apply(this,c)];return c[0]}},each:function(b,c,d){if(a&&b.forEach===a)b.forEach(c,d);else if(b.length===b.length+0)for(var e=0,f=b.length;f>e&&!(e in b&&c.call(d,b[e],e)===this.BREAK);e++);else for(e in b)if(c.call(d,b[e],e)===this.BREAK)break},defer:function(a){setTimeout(a,0)},toArray:function(a){return a.toArray?a.toArray():b.call(a)},isUndefined:function(a){return void 0===a},isNull:function(a){return null===a},isNaN:function(a){return a!==a},isArray:Array.isArray||function(a){return a.constructor===Array},isObject:function(a){return a===Object(a)},isNumber:function(a){return a===a+0},isString:function(a){return a===a+""},isBoolean:function(a){return a===!1||a===!0},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)}}}(),dat.controllers.Controller=function(a){var b=function(a,b){this.initialValue=a[b],this.domElement=document.createElement("div"),this.object=a,this.property=b,this.__onFinishChange=this.__onChange=void 0};return a.extend(b.prototype,{onChange:function(a){return this.__onChange=a,this},onFinishChange:function(a){return this.__onFinishChange=a,this},setValue:function(a){return this.object[this.property]=a,this.__onChange&&this.__onChange.call(this,a),this.updateDisplay(),this},getValue:function(){
return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),b}(dat.utils.common),dat.dom.dom=function(a){function b(b){return"0"===b||a.isUndefined(b)?0:(b=b.match(d),a.isNull(b)?0:parseFloat(b[1]))}var c={};a.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(b,d){a.each(b,function(a){c[a]=d})});var d=/(\d+(\.\d+)?)px/,e={makeSelectable:function(a,b){void 0!==a&&void 0!==a.style&&(a.onselectstart=b?function(){return!1}:function(){},a.style.MozUserSelect=b?"auto":"none",a.style.KhtmlUserSelect=b?"auto":"none",a.unselectable=b?"on":"off")},makeFullscreen:function(b,c,d){a.isUndefined(c)&&(c=!0),a.isUndefined(d)&&(d=!0),b.style.position="absolute",c&&(b.style.left=0,b.style.right=0),d&&(b.style.top=0,b.style.bottom=0)},fakeEvent:function(b,d,e,f){var e=e||{},g=c[d];if(!g)throw Error("Event type "+d+" not supported.");var h=document.createEvent(g);switch(g){case"MouseEvents":h.initMouseEvent(d,e.bubbles||!1,e.cancelable||!0,window,e.clickCount||1,0,0,e.x||e.clientX||0,e.y||e.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":g=h.initKeyboardEvent||h.initKeyEvent,a.defaults(e,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),g(d,e.bubbles||!1,e.cancelable,window,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.keyCode,e.charCode);break;default:h.initEvent(d,e.bubbles||!1,e.cancelable||!0)}a.defaults(h,f),b.dispatchEvent(h)},bind:function(a,b,c,d){return a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+b,c),e},unbind:function(a,b,c,d){return a.removeEventListener?a.removeEventListener(b,c,d||!1):a.detachEvent&&a.detachEvent("on"+b,c),e},addClass:function(a,b){if(void 0===a.className)a.className=b;else if(a.className!==b){var c=a.className.split(/ +/);-1==c.indexOf(b)&&(c.push(b),a.className=c.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return e},removeClass:function(a,b){if(b){if(void 0!==a.className)if(a.className===b)a.removeAttribute("class");else{var c=a.className.split(/ +/),d=c.indexOf(b);-1!=d&&(c.splice(d,1),a.className=c.join(" "))}}else a.className=void 0;return e},hasClass:function(a,b){return RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)").test(a.className)||!1},getWidth:function(a){return a=getComputedStyle(a),b(a["border-left-width"])+b(a["border-right-width"])+b(a["padding-left"])+b(a["padding-right"])+b(a.width)},getHeight:function(a){return a=getComputedStyle(a),b(a["border-top-width"])+b(a["border-bottom-width"])+b(a["padding-top"])+b(a["padding-bottom"])+b(a.height)},getOffset:function(a){var b={left:0,top:0};if(a.offsetParent)do b.left+=a.offsetLeft,b.top+=a.offsetTop;while(a=a.offsetParent);return b},isActive:function(a){return a===document.activeElement&&(a.type||a.href)}};return e}(dat.utils.common),dat.controllers.OptionController=function(a,b,c){var d=function(a,e,f){d.superclass.call(this,a,e);var g=this;if(this.__select=document.createElement("select"),c.isArray(f)){var h={};c.each(f,function(a){h[a]=a}),f=h}c.each(f,function(a,b){var c=document.createElement("option");c.innerHTML=b,c.setAttribute("value",a),g.__select.appendChild(c)}),this.updateDisplay(),b.bind(this.__select,"change",function(){g.setValue(this.options[this.selectedIndex].value)}),this.domElement.appendChild(this.__select)};return d.superclass=a,c.extend(d.prototype,a.prototype,{setValue:function(a){return a=d.superclass.prototype.setValue.call(this,a),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),a},updateDisplay:function(){return this.__select.value=this.getValue(),d.superclass.prototype.updateDisplay.call(this)}}),d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.NumberController=function(a,b){var c=function(a,d,e){c.superclass.call(this,a,d),e=e||{},this.__min=e.min,this.__max=e.max,this.__step=e.step,a=this.__impliedStep=b.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step,a=a.toString(),this.__precision=a.indexOf(".")>-1?a.length-a.indexOf(".")-1:0};return c.superclass=a,b.extend(c.prototype,a.prototype,{setValue:function(a){return void 0!==this.__min&&a<this.__min?a=this.__min:void 0!==this.__max&&a>this.__max&&(a=this.__max),void 0!==this.__step&&a%this.__step!=0&&(a=Math.round(a/this.__step)*this.__step),c.superclass.prototype.setValue.call(this,a)},min:function(a){return this.__min=a,this},max:function(a){return this.__max=a,this},step:function(a){return this.__step=a,this}}),c}(dat.controllers.Controller,dat.utils.common),dat.controllers.NumberControllerBox=function(a,b,c){var d=function(a,e,f){function g(){var a=parseFloat(k.__input.value);c.isNaN(a)||k.setValue(a)}function h(a){var b=j-a.clientY;k.setValue(k.getValue()+b*k.__impliedStep),j=a.clientY}function i(){b.unbind(window,"mousemove",h),b.unbind(window,"mouseup",i)}this.__truncationSuspended=!1,d.superclass.call(this,a,e,f);var j,k=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),b.bind(this.__input,"change",g),b.bind(this.__input,"blur",function(){g(),k.__onFinishChange&&k.__onFinishChange.call(k,k.getValue())}),b.bind(this.__input,"mousedown",function(a){b.bind(window,"mousemove",h),b.bind(window,"mouseup",i),j=a.clientY}),b.bind(this.__input,"keydown",function(a){13===a.keyCode&&(k.__truncationSuspended=!0,this.blur(),k.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return d.superclass=a,c.extend(d.prototype,a.prototype,{updateDisplay:function(){var a,b=this.__input;if(this.__truncationSuspended)a=this.getValue();else{a=this.getValue();var c=Math.pow(10,this.__precision);a=Math.round(a*c)/c}return b.value=a,d.superclass.prototype.updateDisplay.call(this)}}),d}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common),dat.controllers.NumberControllerSlider=function(a,b,c,d,e){var f=function(a,c,d,e,g){function h(a){a.preventDefault();var c=b.getOffset(j.__background),d=b.getWidth(j.__background);return j.setValue(j.__min+(j.__max-j.__min)*((a.clientX-c.left)/(c.left+d-c.left))),!1}function i(){b.unbind(window,"mousemove",h),b.unbind(window,"mouseup",i),j.__onFinishChange&&j.__onFinishChange.call(j,j.getValue())}f.superclass.call(this,a,c,{min:d,max:e,step:g});var j=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),b.bind(this.__background,"mousedown",function(a){b.bind(window,"mousemove",h),b.bind(window,"mouseup",i),h(a)}),b.addClass(this.__background,"slider"),b.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return f.superclass=a,f.useDefaultStyles=function(){c.inject(e)},d.extend(f.prototype,a.prototype,{updateDisplay:function(){return this.__foreground.style.width=(this.getValue()-this.__min)/(this.__max-this.__min)*100+"%",f.superclass.prototype.updateDisplay.call(this)}}),f}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),dat.controllers.FunctionController=function(a,b,c){var d=function(a,c,e){d.superclass.call(this,a,c);var f=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===e?"Fire":e,b.bind(this.__button,"click",function(a){return a.preventDefault(),f.fire(),!1}),b.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return d.superclass=a,c.extend(d.prototype,a.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.BooleanController=function(a,b,c){var d=function(a,c){d.superclass.call(this,a,c);var e=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),b.bind(this.__checkbox,"change",function(){e.setValue(!e.__prev)},!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return d.superclass=a,c.extend(d.prototype,a.prototype,{setValue:function(a){return a=d.superclass.prototype.setValue.call(this,a),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),a},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,d.superclass.prototype.updateDisplay.call(this)}}),d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.color.toString=function(a){return function(b){if(1==b.a||a.isUndefined(b.a)){for(b=b.hex.toString(16);b.length<6;)b="0"+b;return"#"+b}return"rgba("+Math.round(b.r)+","+Math.round(b.g)+","+Math.round(b.b)+","+b.a+")"}}(dat.utils.common),dat.color.interpret=function(a,b){var c,d,e=[{litmus:b.isString,conversions:{THREE_CHAR_HEX:{read:function(a){return a=a.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i),null===a?!1:{space:"HEX",hex:parseInt("0x"+a[1].toString()+a[1].toString()+a[2].toString()+a[2].toString()+a[3].toString()+a[3].toString())}},write:a},SIX_CHAR_HEX:{read:function(a){return a=a.match(/^#([A-F0-9]{6})$/i),null===a?!1:{space:"HEX",hex:parseInt("0x"+a[1].toString())}},write:a},CSS_RGB:{read:function(a){return a=a.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/),null===a?!1:{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3])}},write:a},CSS_RGBA:{read:function(a){return a=a.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/),null===a?!1:{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3]),a:parseFloat(a[4])}},write:a}}},{litmus:b.isNumber,conversions:{HEX:{read:function(a){return{space:"HEX",hex:a,conversionName:"HEX"}},write:function(a){return a.hex}}}},{litmus:b.isArray,conversions:{RGB_ARRAY:{read:function(a){return 3!=a.length?!1:{space:"RGB",r:a[0],g:a[1],b:a[2]}},write:function(a){return[a.r,a.g,a.b]}},RGBA_ARRAY:{read:function(a){return 4!=a.length?!1:{space:"RGB",r:a[0],g:a[1],b:a[2],a:a[3]}},write:function(a){return[a.r,a.g,a.b,a.a]}}}},{litmus:b.isObject,conversions:{RGBA_OBJ:{read:function(a){return b.isNumber(a.r)&&b.isNumber(a.g)&&b.isNumber(a.b)&&b.isNumber(a.a)?{space:"RGB",r:a.r,g:a.g,b:a.b,a:a.a}:!1},write:function(a){return{r:a.r,g:a.g,b:a.b,a:a.a}}},RGB_OBJ:{read:function(a){return b.isNumber(a.r)&&b.isNumber(a.g)&&b.isNumber(a.b)?{space:"RGB",r:a.r,g:a.g,b:a.b}:!1},write:function(a){return{r:a.r,g:a.g,b:a.b}}},HSVA_OBJ:{read:function(a){return b.isNumber(a.h)&&b.isNumber(a.s)&&b.isNumber(a.v)&&b.isNumber(a.a)?{space:"HSV",h:a.h,s:a.s,v:a.v,a:a.a}:!1},write:function(a){return{h:a.h,s:a.s,v:a.v,a:a.a}}},HSV_OBJ:{read:function(a){return b.isNumber(a.h)&&b.isNumber(a.s)&&b.isNumber(a.v)?{space:"HSV",h:a.h,s:a.s,v:a.v}:!1},write:function(a){return{h:a.h,s:a.s,v:a.v}}}}}];return function(){d=!1;var a=arguments.length>1?b.toArray(arguments):arguments[0];return b.each(e,function(e){return e.litmus(a)?(b.each(e.conversions,function(e,f){return c=e.read(a),d===!1&&c!==!1?(d=c,c.conversionName=f,c.conversion=e,b.BREAK):void 0}),b.BREAK):void 0}),d}}(dat.color.toString,dat.utils.common),dat.GUI=dat.gui.GUI=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a,b,c,f){if(void 0===b[c])throw Error("Object "+b+' has no property "'+c+'"');f.color?b=new k(b,c):(b=[b,c].concat(f.factoryArgs),b=d.apply(a,b)),f.before instanceof e&&(f.before=f.before.__li),s(a,b),n.addClass(b.domElement,"c"),c=document.createElement("span"),n.addClass(c,"property-name"),c.innerHTML=b.property;var g=document.createElement("div");return g.appendChild(c),g.appendChild(b.domElement),f=q(a,g,f.before),n.addClass(f,I.CLASS_CONTROLLER_ROW),n.addClass(f,typeof b.getValue()),r(a,f,b),a.__controllers.push(b),b}function q(a,b,c){var d=document.createElement("li");return b&&d.appendChild(b),c?a.__ul.insertBefore(d,params.before):a.__ul.appendChild(d),a.onResize(),d}function r(a,b,c){if(c.__li=b,c.__gui=a,o.extend(c,{options:function(b){return arguments.length>1?(c.remove(),p(a,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[o.toArray(arguments)]})):o.isArray(b)||o.isObject(b)?(c.remove(),p(a,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[b]})):void 0},name:function(a){return c.__li.firstElementChild.firstElementChild.innerHTML=a,c},listen:function(){return c.__gui.listen(c),c},remove:function(){return c.__gui.remove(c),c}}),c instanceof i){var d=new h(c.object,c.property,{min:c.__min,max:c.__max,step:c.__step});o.each(["updateDisplay","onChange","onFinishChange"],function(a){var b=c[a],e=d[a];c[a]=d[a]=function(){var a=Array.prototype.slice.call(arguments);return b.apply(c,a),e.apply(d,a)}}),n.addClass(b,"has-slider"),c.domElement.insertBefore(d.domElement,c.domElement.firstElementChild)}else if(c instanceof h){var e=function(b){return o.isNumber(c.__min)&&o.isNumber(c.__max)?(c.remove(),p(a,c.object,c.property,{before:c.__li.nextElementSibling,factoryArgs:[c.__min,c.__max,c.__step]})):b};c.min=o.compose(e,c.min),c.max=o.compose(e,c.max)}else c instanceof f?(n.bind(b,"click",function(){n.fakeEvent(c.__checkbox,"click")}),n.bind(c.__checkbox,"click",function(a){a.stopPropagation()})):c instanceof g?(n.bind(b,"click",function(){n.fakeEvent(c.__button,"click")}),n.bind(b,"mouseover",function(){n.addClass(c.__button,"hover")}),n.bind(b,"mouseout",function(){n.removeClass(c.__button,"hover")})):c instanceof k&&(n.addClass(b,"color"),c.updateDisplay=o.compose(function(a){return b.style.borderLeftColor=c.__color.toString(),a},c.updateDisplay),c.updateDisplay());c.setValue=o.compose(function(b){return a.getRoot().__preset_select&&c.isModified()&&y(a.getRoot(),!0),b},c.setValue)}function s(a,b){var c=a.getRoot(),d=c.__rememberedObjects.indexOf(b.object);if(-1!=d){var e=c.__rememberedObjectIndecesToControllers[d];if(void 0===e&&(e={},c.__rememberedObjectIndecesToControllers[d]=e),e[b.property]=b,c.load&&c.load.remembered){if(c=c.load.remembered,c[a.preset])c=c[a.preset];else{if(!c[B])return;c=c[B]}c[d]&&void 0!==c[d][b.property]&&(d=c[d][b.property],b.initialValue=d,b.setValue(d))}}}function t(a){var b=a.__save_row=document.createElement("li");n.addClass(a.domElement,"has-save"),a.__ul.insertBefore(b,a.__ul.firstChild),n.addClass(b,"save-row");var c=document.createElement("span");c.innerHTML="&nbsp;",n.addClass(c,"button gears");var d=document.createElement("span");d.innerHTML="Save",n.addClass(d,"button"),n.addClass(d,"save");var e=document.createElement("span");e.innerHTML="New",n.addClass(e,"button"),n.addClass(e,"save-as");var f=document.createElement("span");f.innerHTML="Revert",n.addClass(f,"button"),n.addClass(f,"revert");var g=a.__preset_select=document.createElement("select");if(a.load&&a.load.remembered?o.each(a.load.remembered,function(b,c){x(a,c,c==a.preset)}):x(a,B,!1),n.bind(g,"change",function(){for(var b=0;b<a.__preset_select.length;b++)a.__preset_select[b].innerHTML=a.__preset_select[b].value;a.preset=this.value}),b.appendChild(g),b.appendChild(c),b.appendChild(d),b.appendChild(e),b.appendChild(f),A){var b=document.getElementById("dg-save-locally"),h=document.getElementById("dg-local-explain");b.style.display="block",b=document.getElementById("dg-local-storage"),"true"===localStorage.getItem(document.location.href+".isLocal")&&b.setAttribute("checked","checked");var i=function(){h.style.display=a.useLocalStorage?"block":"none"};i(),n.bind(b,"change",function(){a.useLocalStorage=!a.useLocalStorage,i()})}var j=document.getElementById("dg-new-constructor");n.bind(j,"keydown",function(a){a.metaKey&&(67===a.which||67==a.keyCode)&&D.hide()}),n.bind(c,"click",function(){j.innerHTML=JSON.stringify(a.getSaveObject(),void 0,2),D.show(),j.focus(),j.select()}),n.bind(d,"click",function(){a.save()}),n.bind(e,"click",function(){var b=prompt("Enter a new preset name.");b&&a.saveAs(b)}),n.bind(f,"click",function(){a.revert()})}function u(a){function b(b){return b.preventDefault(),e=b.clientX,n.addClass(a.__closeButton,I.CLASS_DRAG),n.bind(window,"mousemove",c),n.bind(window,"mouseup",d),!1}function c(b){return b.preventDefault(),a.width+=e-b.clientX,a.onResize(),e=b.clientX,!1}function d(){n.removeClass(a.__closeButton,I.CLASS_DRAG),n.unbind(window,"mousemove",c),n.unbind(window,"mouseup",d)}a.__resize_handle=document.createElement("div"),o.extend(a.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var e;n.bind(a.__resize_handle,"mousedown",b),n.bind(a.__closeButton,"mousedown",b),a.domElement.insertBefore(a.__resize_handle,a.domElement.firstElementChild)}function v(a,b){a.domElement.style.width=b+"px",a.__save_row&&a.autoPlace&&(a.__save_row.style.width=b+"px"),a.__closeButton&&(a.__closeButton.style.width=b+"px")}function w(a,b){var c={};return o.each(a.__rememberedObjects,function(d,e){var f={};o.each(a.__rememberedObjectIndecesToControllers[e],function(a,c){f[c]=b?a.initialValue:a.getValue()}),c[e]=f}),c}function x(a,b,c){var d=document.createElement("option");d.innerHTML=b,d.value=b,a.__preset_select.appendChild(d),c&&(a.__preset_select.selectedIndex=a.__preset_select.length-1)}function y(a,b){var c=a.__preset_select[a.__preset_select.selectedIndex];c.innerHTML=b?c.value+"*":c.value}function z(a){0!=a.length&&l(function(){z(a)}),o.each(a,function(a){a.updateDisplay()})}a.inject(c);var A,B="Default";try{A="localStorage"in window&&null!==window.localStorage}catch(C){A=!1}var D,E,F=!0,G=!1,H=[],I=function(a){function b(){localStorage.setItem(document.location.href+".gui",JSON.stringify(d.getSaveObject()))}function c(){var a=d.getRoot();a.width+=1,o.defer(function(){a.width-=1})}var d=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),n.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],a=a||{},a=o.defaults(a,{autoPlace:!0,width:I.DEFAULT_WIDTH}),a=o.defaults(a,{resizable:a.autoPlace,hideable:a.autoPlace}),o.isUndefined(a.load)?a.load={preset:B}:a.preset&&(a.load.preset=a.preset),o.isUndefined(a.parent)&&a.hideable&&H.push(this),a.resizable=o.isUndefined(a.parent)&&a.resizable,a.autoPlace&&o.isUndefined(a.scrollable)&&(a.scrollable=!0);var e=A&&"true"===localStorage.getItem(document.location.href+".isLocal");if(Object.defineProperties(this,{parent:{get:function(){return a.parent}},scrollable:{get:function(){return a.scrollable}},autoPlace:{get:function(){return a.autoPlace}},preset:{get:function(){return d.parent?d.getRoot().preset:a.load.preset},set:function(b){for(d.parent?d.getRoot().preset=b:a.load.preset=b,b=0;b<this.__preset_select.length;b++)this.__preset_select[b].value==this.preset&&(this.__preset_select.selectedIndex=b);d.revert()}},width:{get:function(){return a.width},set:function(b){a.width=b,v(d,b)}},name:{get:function(){return a.name},set:function(b){a.name=b,g&&(g.innerHTML=a.name)}},closed:{get:function(){return a.closed},set:function(b){a.closed=b,a.closed?n.addClass(d.__ul,I.CLASS_CLOSED):n.removeClass(d.__ul,I.CLASS_CLOSED),this.onResize(),d.__closeButton&&(d.__closeButton.innerHTML=b?I.TEXT_OPEN:I.TEXT_CLOSED)}},load:{get:function(){return a.load}},useLocalStorage:{get:function(){return e},set:function(a){A&&((e=a)?n.bind(window,"unload",b):n.unbind(window,"unload",b),localStorage.setItem(document.location.href+".isLocal",a))}}}),o.isUndefined(a.parent)){if(a.closed=!1,n.addClass(this.domElement,I.CLASS_MAIN),n.makeSelectable(this.domElement,!1),A&&e){d.useLocalStorage=!0;var f=localStorage.getItem(document.location.href+".gui");f&&(a.load=JSON.parse(f))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=I.TEXT_CLOSED,n.addClass(this.__closeButton,I.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),n.bind(this.__closeButton,"click",function(){d.closed=!d.closed})}else{void 0===a.closed&&(a.closed=!0);var g=document.createTextNode(a.name);n.addClass(g,"controller-name"),f=q(d,g),n.addClass(this.__ul,I.CLASS_CLOSED),n.addClass(f,"title"),n.bind(f,"click",function(a){return a.preventDefault(),d.closed=!d.closed,!1}),a.closed||(this.closed=!1)}a.autoPlace&&(o.isUndefined(a.parent)&&(F&&(E=document.createElement("div"),n.addClass(E,"dg"),n.addClass(E,I.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(E),F=!1),E.appendChild(this.domElement),n.addClass(this.domElement,I.CLASS_AUTO_PLACE)),this.parent||v(d,a.width)),n.bind(window,"resize",function(){d.onResize()}),n.bind(this.__ul,"webkitTransitionEnd",function(){d.onResize()}),n.bind(this.__ul,"transitionend",function(){d.onResize()}),n.bind(this.__ul,"oTransitionEnd",function(){d.onResize()}),this.onResize(),a.resizable&&u(this),d.getRoot(),a.parent||c()};return I.toggleHide=function(){G=!G,o.each(H,function(a){a.domElement.style.zIndex=G?-999:999,a.domElement.style.opacity=G?0:1})},I.CLASS_AUTO_PLACE="a",I.CLASS_AUTO_PLACE_CONTAINER="ac",I.CLASS_MAIN="main",I.CLASS_CONTROLLER_ROW="cr",I.CLASS_TOO_TALL="taller-than-window",I.CLASS_CLOSED="closed",I.CLASS_CLOSE_BUTTON="close-button",I.CLASS_DRAG="drag",I.DEFAULT_WIDTH=245,I.TEXT_CLOSED="Close Controls",I.TEXT_OPEN="Open Controls",n.bind(window,"keydown",function(a){"text"!==document.activeElement.type&&(72===a.which||72==a.keyCode)&&I.toggleHide()},!1),o.extend(I.prototype,{add:function(a,b){return p(this,a,b,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(a,b){return p(this,a,b,{color:!0})},remove:function(a){this.__ul.removeChild(a.__li),this.__controllers.slice(this.__controllers.indexOf(a),1);var b=this;o.defer(function(){b.onResize()})},destroy:function(){this.autoPlace&&E.removeChild(this.domElement)},addFolder:function(a){if(void 0!==this.__folders[a])throw Error('You already have a folder in this GUI by the name "'+a+'"');var b={name:a,parent:this};return b.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[a]&&(b.closed=this.load.folders[a].closed,b.load=this.load.folders[a]),b=new I(b),this.__folders[a]=b,a=q(this,b.domElement),n.addClass(a,"folder"),b},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var a=this.getRoot();if(a.scrollable){var b=n.getOffset(a.__ul).top,c=0;o.each(a.__ul.childNodes,function(b){a.autoPlace&&b===a.__save_row||(c+=n.getHeight(b))}),window.innerHeight-b-20<c?(n.addClass(a.domElement,I.CLASS_TOO_TALL),a.__ul.style.height=window.innerHeight-b-20+"px"):(n.removeClass(a.domElement,I.CLASS_TOO_TALL),a.__ul.style.height="auto")}a.__resize_handle&&o.defer(function(){a.__resize_handle.style.height=a.__ul.offsetHeight+"px"}),a.__closeButton&&(a.__closeButton.style.width=a.width+"px")},remember:function(){if(o.isUndefined(D)&&(D=new m,D.domElement.innerHTML=b),this.parent)throw Error("You can only call remember on a top level GUI.");var a=this;o.each(Array.prototype.slice.call(arguments),function(b){0==a.__rememberedObjects.length&&t(a),-1==a.__rememberedObjects.indexOf(b)&&a.__rememberedObjects.push(b)}),this.autoPlace&&v(this,this.width)},getRoot:function(){for(var a=this;a.parent;)a=a.parent;return a},getSaveObject:function(){var a=this.load;return a.closed=this.closed,this.__rememberedObjects.length>0&&(a.preset=this.preset,a.remembered||(a.remembered={}),a.remembered[this.preset]=w(this)),a.folders={},o.each(this.__folders,function(b,c){a.folders[c]=b.getSaveObject()}),a},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=w(this),y(this,!1)},saveAs:function(a){this.load.remembered||(this.load.remembered={},this.load.remembered[B]=w(this,!0)),this.load.remembered[a]=w(this),this.preset=a,x(this,a,!0)},revert:function(a){o.each(this.__controllers,function(b){this.getRoot().load.remembered?s(a||this.getRoot(),b):b.setValue(b.initialValue)},this),o.each(this.__folders,function(a){a.revert(a)}),a||y(this.getRoot(),!1)},listen:function(a){var b=0==this.__listening.length;this.__listening.push(a),b&&z(this.__listening)}}),I}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",dat.controllers.factory=function(a,b,c,d,e,f,g){return function(h,i,j,k){var l=h[i];return g.isArray(j)||g.isObject(j)?new a(h,i,j):g.isNumber(l)?g.isNumber(j)&&g.isNumber(k)?new c(h,i,j,k):new b(h,i,{min:j,max:k}):g.isString(l)?new d(h,i):g.isFunction(l)?new e(h,i,""):g.isBoolean(l)?new f(h,i):void 0}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(a,b,c){var d=function(a,c){function e(){f.setValue(f.__input.value)}d.superclass.call(this,a,c);var f=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),b.bind(this.__input,"keyup",e),b.bind(this.__input,"change",e),b.bind(this.__input,"blur",function(){f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}),b.bind(this.__input,"keydown",function(a){13===a.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return d.superclass=a,c.extend(d.prototype,a.prototype,{updateDisplay:function(){return b.isActive(this.__input)||(this.__input.value=this.getValue()),d.superclass.prototype.updateDisplay.call(this)}}),d}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(a,b,c,d,e){
function f(a,b,c,d){a.style.background="",e.each(i,function(e){a.style.cssText+="background: "+e+"linear-gradient("+b+", "+c+" 0%, "+d+" 100%); "})}function g(a){a.style.background="",a.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",a.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var h=function(a,i){function j(a){n(a),b.bind(window,"mousemove",n),b.bind(window,"mouseup",k)}function k(){b.unbind(window,"mousemove",n),b.unbind(window,"mouseup",k)}function l(){var a=d(this.value);a!==!1?(p.__color.__state=a,p.setValue(p.__color.toOriginal())):this.value=p.__color.toString()}function m(){b.unbind(window,"mousemove",o),b.unbind(window,"mouseup",m)}function n(a){a.preventDefault();var c=b.getWidth(p.__saturation_field),d=b.getOffset(p.__saturation_field),e=(a.clientX-d.left+document.body.scrollLeft)/c,a=1-(a.clientY-d.top+document.body.scrollTop)/c;return a>1?a=1:0>a&&(a=0),e>1?e=1:0>e&&(e=0),p.__color.v=a,p.__color.s=e,p.setValue(p.__color.toOriginal()),!1}function o(a){a.preventDefault();var c=b.getHeight(p.__hue_field),d=b.getOffset(p.__hue_field),a=1-(a.clientY-d.top+document.body.scrollTop)/c;return a>1?a=1:0>a&&(a=0),p.__color.h=360*a,p.setValue(p.__color.toOriginal()),!1}h.superclass.call(this,a,i),this.__color=new c(this.getValue()),this.__temp=new c(0);var p=this;this.domElement=document.createElement("div"),b.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",b.bind(this.__input,"keydown",function(a){13===a.keyCode&&l.call(this)}),b.bind(this.__input,"blur",l),b.bind(this.__selector,"mousedown",function(){b.addClass(this,"drag").bind(window,"mouseup",function(){b.removeClass(p.__selector,"drag")})});var q=document.createElement("div");e.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),e.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),e.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),e.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),e.extend(q.style,{width:"100%",height:"100%",background:"none"}),f(q,"top","rgba(0,0,0,0)","#000"),e.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),g(this.__hue_field),e.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),b.bind(this.__saturation_field,"mousedown",j),b.bind(this.__field_knob,"mousedown",j),b.bind(this.__hue_field,"mousedown",function(a){o(a),b.bind(window,"mousemove",o),b.bind(window,"mouseup",m)}),this.__saturation_field.appendChild(q),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};h.superclass=a,e.extend(h.prototype,a.prototype,{updateDisplay:function(){var a=d(this.getValue());if(a!==!1){var b=!1;e.each(c.COMPONENTS,function(c){return e.isUndefined(a[c])||e.isUndefined(this.__color.__state[c])||a[c]===this.__color.__state[c]?void 0:(b=!0,{})},this),b&&e.extend(this.__color.__state,a)}e.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var g=this.__color.v<.5||this.__color.s>.5?255:0,h=255-g;e.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+g+","+g+","+g+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,f(this.__saturation_field,"left","#fff",this.__temp.toString()),e.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+g+","+g+","+g+")",textShadow:this.__input_textShadow+"rgba("+h+","+h+","+h+",.7)"})}});var i=["-moz-","-o-","-webkit-","-ms-",""];return h}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(a,b,c,d){function e(a,b,c){Object.defineProperty(a,b,{get:function(){return"RGB"===this.__state.space?this.__state[b]:(g(this,b,c),this.__state[b])},set:function(a){"RGB"!==this.__state.space&&(g(this,b,c),this.__state.space="RGB"),this.__state[b]=a}})}function f(a,b){Object.defineProperty(a,b,{get:function(){return"HSV"===this.__state.space?this.__state[b]:(h(this),this.__state[b])},set:function(a){"HSV"!==this.__state.space&&(h(this),this.__state.space="HSV"),this.__state[b]=a}})}function g(a,c,e){if("HEX"===a.__state.space)a.__state[c]=b.component_from_hex(a.__state.hex,e);else{if("HSV"!==a.__state.space)throw"Corrupted color state";d.extend(a.__state,b.hsv_to_rgb(a.__state.h,a.__state.s,a.__state.v))}}function h(a){var c=b.rgb_to_hsv(a.r,a.g,a.b);d.extend(a.__state,{s:c.s,v:c.v}),d.isNaN(c.h)?d.isUndefined(a.__state.h)&&(a.__state.h=0):a.__state.h=c.h}var i=function(){if(this.__state=a.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return i.COMPONENTS="r,g,b,h,s,v,hex,a".split(","),d.extend(i.prototype,{toString:function(){return c(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),e(i.prototype,"r",2),e(i.prototype,"g",1),e(i.prototype,"b",0),f(i.prototype,"h"),f(i.prototype,"s"),f(i.prototype,"v"),Object.defineProperty(i.prototype,"a",{get:function(){return this.__state.a},set:function(a){this.__state.a=a}}),Object.defineProperty(i.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=b.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(a){this.__state.space="HEX",this.__state.hex=a}}),i}(dat.color.interpret,dat.color.math=function(){var a;return{hsv_to_rgb:function(a,b,c){var d=a/60-Math.floor(a/60),e=c*(1-b),f=c*(1-d*b),b=c*(1-(1-d)*b),a=[[c,b,e],[f,c,e],[e,c,b],[e,f,c],[b,e,c],[c,e,f]][Math.floor(a/60)%6];return{r:255*a[0],g:255*a[1],b:255*a[2]}},rgb_to_hsv:function(a,b,c){var d=Math.min(a,b,c),e=Math.max(a,b,c),d=e-d;return 0==e?{h:NaN,s:0,v:0}:(a=a==e?(b-c)/d:b==e?2+(c-a)/d:4+(a-b)/d,a/=6,0>a&&(a+=1),{h:360*a,s:d/e,v:e/255})},rgb_to_hex:function(a,b,c){return a=this.hex_with_component(0,2,a),a=this.hex_with_component(a,1,b),a=this.hex_with_component(a,0,c)},component_from_hex:function(a,b){return a>>8*b&255},hex_with_component:function(b,c,d){return d<<(a=8*c)|b&~(255<<a)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),dat.dom.CenteredDiv=function(a,b){var c=function(){this.backgroundElement=document.createElement("div"),b.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),a.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),b.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var c=this;a.bind(this.backgroundElement,"click",function(){c.hide()})};return c.prototype.show=function(){var a=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),b.defer(function(){a.backgroundElement.style.opacity=1,a.domElement.style.opacity=1,a.domElement.style.webkitTransform="scale(1)"})},c.prototype.hide=function(){var b=this,c=function(){b.domElement.style.display="none",b.backgroundElement.style.display="none",a.unbind(b.domElement,"webkitTransitionEnd",c),a.unbind(b.domElement,"transitionend",c),a.unbind(b.domElement,"oTransitionEnd",c)};a.bind(this.domElement,"webkitTransitionEnd",c),a.bind(this.domElement,"transitionend",c),a.bind(this.domElement,"oTransitionEnd",c),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},c.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-a.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-a.getHeight(this.domElement)/2+"px"},c}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common);var AppView=Backbone.View.extend({el:"#canvas",initialize:function(){_.bindAll(this,"render","start","showAnnounce","hideAnnounce","dragover","dropped","readfile"),this.render(),window.addEventListener("dragover",this.dragover,!1),window.addEventListener("drop",this.dropped,!1),app.CanvasView.on("hideAnnounce",this.hideAnnounce)},render:function(){$(this.el).append($(app.CanvasView.render().el)),app.DatView.render()},showAnnounce:function(){$(this.el).find("#drop-zone").show()},hideAnnounce:function(){$(this.el).find("#drop-zone").hide()},dragover:function(a){a.preventDefault()},dropped:function(a){a.preventDefault();var b=a.dataTransfer.files[0],c=b.type;if(c.match(/image\/\w+/)){var d=function(a){var b=a.target.result;app.CanvasView.setImage(b)};this.readfile(b,d)}else if(c.match(/video\/\w+/)){var d=function(a){var b=a.target.result;app.CanvasView.setVideo(b)};this.readfile(b,d)}else alert("Only image and video is supported.")},readfile:function(a,b){app.CanvasView.init();var c=new FileReader;c.onload=b,c.readAsDataURL(a)},start:function(){app.CanvasView.animate()}}),DatView=Backbone.View.extend({el:"#gui-container",dat:null,params:null,theta:0,initialize:function(){_.bindAll(this,"render","save","update","updateTheta");var a=this,b=function(b){this.title="This is WebGL Glitch",this.format=b.RGBA,this.type=b.UNSIGNED_BYTE,this.minWidth=0,this.maxWidth=100,this.width=100,this.animateWidth=!1,this.minHeight=0,this.maxHeight=100,this.height=100,this.animateHeight=!1,this.minOffset=0,this.maxOffset=100,this.offset=0,this.animateOffset=!1,this.save=a.save},c=$(app.CanvasView.el)[0]._.gl;this.params=new b(c),this.dat=new dat.GUI({autoPlace:!1,width:320})},render:function(){var a=$(app.CanvasView.el)[0]._.gl,b={ALPHA:a.ALPHA,LUMINANCE:a.LUMINANCE,LUMINANCE_ALPHA:a.LUMINANCE_ALPHA,RGB:a.RGB,RGBA:a.RGBA},c={UNSIGNED_BYTE:a.UNSIGNED_BYTE};this.dat.add(this.params,"title"),this.dat.add(this.params,"format",b).onChange(app.CanvasView.format),this.dat.add(this.params,"type",c).onChange(app.CanvasView.type);var d;return d=this.dat.addFolder("width"),d.add(this.params,"minWidth").min(0).max(100).step(.1).name("min"),d.add(this.params,"maxWidth").min(0).max(100).step(.1).name("max"),d.add(this.params,"width").min(0).max(100).step(.1).onChange(app.CanvasView.width),d.add(this.params,"animateWidth").name("animate"),d.close(),d=this.dat.addFolder("height"),d.add(this.params,"minHeight").min(0).max(100).step(.1).name("min"),d.add(this.params,"maxHeight").min(0).max(100).step(.1).name("max"),d.add(this.params,"height").min(0).max(100).step(.1).onChange(app.CanvasView.height),d.add(this.params,"animateHeight").name("animate"),d.close(),d=this.dat.addFolder("offset"),d.add(this.params,"minOffset").min(0).max(100).step(.1).name("min"),d.add(this.params,"maxOffset").min(0).max(100).step(.1).name("max"),d.add(this.params,"offset").min(0).max(100).step(.1).onChange(app.CanvasView.offset),d.add(this.params,"animateOffset").name("animate"),d.close(),this.dat.add(this.params,"save").name("save image"),$(this.el).append(this.dat.domElement),this},save:function(){(image=$(app.CanvasView.el)[0].toDataURL("image/jpeg"))&&window.open(image)},update:function(){var a=this.dat.get("minWidth"),b=this.dat.get("width"),c=this.dat.get("maxWidth");if(a.getValue()>c.getValue()&&a.setValue(c.getValue()),a.getValue()>b.getValue()&&b.setValue(a.getValue()),c.getValue()<b.getValue()&&b.setValue(c.getValue()),this.dat.get("animateWidth").getValue()){var d=c.getValue()-a.getValue();this.params.width=Math.cos(this.theta/Math.PI*180)*d/2+d/2+a.getValue()}var a=this.dat.get("minHeight"),b=this.dat.get("height"),c=this.dat.get("maxHeight");if(a.getValue()>c.getValue()&&a.setValue(c.getValue()),a.getValue()>b.getValue()&&b.setValue(a.getValue()),c.getValue()<b.getValue()&&b.setValue(c.getValue()),this.dat.get("animateHeight").getValue()){var d=c.getValue()-a.getValue();this.params.height=Math.cos(this.theta/Math.PI*180)*d/2+d/2+a.getValue()}var a=this.dat.get("minOffset"),b=this.dat.get("offset"),c=this.dat.get("maxOffset");if(a.getValue()>c.getValue()&&a.setValue(c.getValue()),a.getValue()>b.getValue()&&b.setValue(a.getValue()),c.getValue()<b.getValue()&&b.setValue(c.getValue()),this.dat.get("animateOffset").getValue()){var d=c.getValue()-a.getValue();this.params.offset=Math.cos(this.theta/Math.PI*180)*d/2+d/2+a.getValue()}for(var e in this.dat.__controllers)this.dat.__controllers[e].updateDisplay();for(var f in this.dat.__folders)for(var e in this.dat.__folders[f].__controllers)this.dat.__folders[f].__controllers[e].updateDisplay();this.updateTheta()},updateTheta:function(){this.theta>360?this.theta=0:this.theta+=.0012}}),CanvasView=Backbone.View.extend({texture:null,canvas:null,filter:null,initialize:function(){_.bindAll(this,"init","render","format","type","width","height","offset","setImage","setVideo","animate","videoReady","videoEnded"),this.canvas=fx.canvas(),this.setElement(this.canvas)},init:function(){this.texture&&(this.texture.destroy(),this.texture=null),app.VideoView&&app.VideoView.dispose(),this.filter=null},format:function(a){return void 0!==a?void this.filter.format(parseInt(a)):void 0},type:function(a){return void 0!==a?void this.filter.type(parseInt(a)):void 0},width:function(a){return void 0!==a?void this.filter.shortenX(parseInt(this.texture._.width*(100-a)/100)):void 0},height:function(a){return void 0!==a?void this.filter.shortenY(parseInt(this.texture._.height*(100-a)/100)):void 0},offset:function(a){return void 0!==a?void this.filter.offset(parseInt(a)):void 0},render:function(){return this},setImage:function(a){var b,c=this,d=function(a){c.trigger("hideAnnounce"),$(c.el).css("margin-top",-b.height/2).css("margin-left",-b.width/2).show(),c.texture=c.el.texture(b),c.canvas.draw(c.texture).update(),c.filter=c.el.glitch(c.texture)};b=new Image,b.src=a,b.onload=d},setVideo:function(a){app.VideoView=new VideoView,$("#canvas").append($(app.VideoView.render().el)),app.VideoView.render(),app.VideoView.el.src=a,app.VideoView.on("ready",this.videoReady),app.VideoView.on("ended",this.videoEnded)},videoReady:function(){},videoEnded:function(){app.VideoView&&(app.VideoView.off("ended"),app.VideoView.dispose()),this.filter=null,console.log("video ended")},animate:function(){if(this.filter){if(app.VideoView&&app.VideoView.el&&app.VideoView.el.videoCanvas){var a=app.VideoView.el.videoCanvas.getContext("2d");a.drawImage(app.VideoView.el,0,0,app.VideoView.el.videoCanvas.width,app.VideoView.el.videoCanvas.height);var b=app.VideoView.el.videoCanvas.toDataURL("image/jpeg");this.setImage(b)}app.DatView.update(),this.format(app.DatView.dat.get("format").getValue()),this.type(app.DatView.dat.get("type").getValue()),this.width(app.DatView.dat.get("width").getValue()),this.height(app.DatView.dat.get("height").getValue()),this.offset(app.DatView.dat.get("offset").getValue()),this.filter.update()}setTimeout(this.animate,1e3/app.fps)}}),VideoView=Backbone.View.extend({tagName:"video",max_width:640,max_height:360,initialize:function(){_.bindAll(this,"dispose","render","onReady","ended"),this.el.addEventListener("loadeddata",this.onReady,!1)},dispose:function(){this.el.removeEventListener("loadeddata",this.onReady,!1),this.el.removeEventListener("ended",this.ended,!1),this.remove()},render:function(){return $(this.el).hide(),this},onReady:function(){this.el.removeEventListener("ended",this.ended,!1),this.el.addEventListener("ended",this.ended,!1),app.AppView.hideAnnounce();var a=$(this.el).width(),b=$(this.el).height();$(this.el).width()>this.max_width?(a=this.max_width,b=parseInt(b*this.max_width/$(this.el).width())):$(this.el).height()>this.max_height&&(a=parseInt(a*this.max_height/$(this.el).height()),b=this.max_height);var c=document.createElement("canvas");c.width=a,c.height=b,this.el.videoCanvas=c,app.CanvasView.texture=app.CanvasView.el.texture(this.el),app.CanvasView.filter=app.CanvasView.el.glitch(app.CanvasView.texture),this.el.play()},ended:function(){this.trigger("ended")}});dat.GUI.prototype.get=function(a){var b;this.__controllers.forEach(function(c){return c.property==a?void(b=c):void 0});for(key in this.__folders)this.__folders[key].__controllers.forEach(function(c){return c.property==a?void(b=c):void 0});return b};var app={};app.fps=24,$(function(){if("undefined"==typeof FileReader){var a="Sorry, but this browser doesn't support FileReader.";throw a}try{app.CanvasView=new CanvasView}catch(b){throw"Sorry, but "+b}app.DatView=new DatView,app.AppView=new AppView,app.AppView.start()});